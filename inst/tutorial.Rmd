---
title: "tutorial of wheatmap"
output: html_document
---

This is a tutorial on the usage of wheatmap for generating complex heatmaps in a procedure way.

A heatmap is easy to generate in R. There are many packages like heatmap2, heatmap3, heatmap.plus and ComplexHeatmaps. But many times, I found myself in a situation of plotting a set of heatmaps in a procedure way. And none-of the above packages are nimble enough to do color-bar reordering, multiple heatmaps that can be positioned arbitrarily. So I wrote this package for that purpose.

We start with some data
```{r}
library(devtools)
load_all('~/tools/wheatmap/wheatmap/',export_all=FALSE)
matrix.data <- cbind(matrix(rnorm(20),nrow=4), 5+matrix(rnorm(8),nrow=4))
row.bar.data <- c(1,2,3,1)
column.bar.data <- c(1:6,6)
dimnames(matrix.data) <- list(c('w','x','y','z'), c('a','b','c','d','e','f','g'))
matrix.data
```

We perform some clustering
```{r}
r.both <- both.cluster(matrix.data)
row.bar.data <- row.bar.data[r.both$row.clust$order]
column.bar.data <- column.bar.data[r.both$column.clust$order]
```

We plot
```{r}
heatmap <- WHeatmap(r.both$mat)
color.bar.left <- WCbar(row.bar.data, 'v', dim=LeftOf(heatmap, 0.1), continuous=FALSE)
color.bar.top <- WCbar(column.bar.data, 'h', dim=TopOf(heatmap, 0.1), continuous=FALSE)
dendro.left <- WDendrogram(r.both$row.clust, facing='right', dim=LeftOf(color.bar.left, 0.1))
dendro.top <- WDendrogram(r.both$column.clust, facing='bottom', dim=TopOf(color.bar.top, 0.1))
WPlot(list(heatmap, color.bar.top, color.bar.left, dendro.left, dendro.top))
```
