---
title: "tutorial of wheatmap"
output: pdf_document
---

This is a tutorial on the usage of wheatmap for generating complex heatmaps in a procedure way.

A heatmap is easy to generate in R. There are many packages like heatmap2, heatmap3, heatmap.plus and ComplexHeatmaps. But many times, I found myself in a situation of plotting a set of heatmaps in a procedure way. And none-of the above packages are nimble enough to do color-bar reordering, multiple heatmaps that can be positioned arbitrarily. So I wrote this package for that purpose.

We start with some data
```{r}
library(devtools)
load_all('~/tools/wheatmap/wheatmap/',export_all=FALSE)
m <- cbind(matrix(rnorm(20),nrow=4), 5+matrix(rnorm(8),nrow=4))
m2 <- matrix(1:16,nrow=4)
dimnames(m) <- list(c('w','x','y','z'), c('a','b','c','d','e','f','g'))
row.data <- c(1,2,3,1)
col.data <- c(1:6,6)
m
```

We perform some clustering
```{r}
c <- both.cluster(m)
row.data <- row.data[c$row.clust$order]
col.data <- col.data[c$column.clust$order]
```

We plot
```{r}
p <- list()
p$heatmap <- WHeatmap(c$mat)
p$color.bar.left <- WColorBarV(row.data, LeftOf(p$heatmap), continuous=FALSE)
p$color.bar.top <- WColorBarH(col.data, TopOf(p$heatmap), continuous=FALSE)
p$dendro.left <- WDendrogram(c$row.clust, LeftOf(p$color.bar.left), facing='right')
p$dendro.top <- WDendrogram(c$column.clust, TopOf(p$color.bar.top), facing='bottom')
p$color.bar.middle <- WColorBarV(1:4, RightOf(p$heatmap))
p$heatmap2 <- WHeatmap(m2, RightOf(p$color.bar.middle))
## p$heatmap3 <- WHeatmap(matrix(c(8:1,1:8)), Beneath(p$heatmap2))
p$color.bar.bottom <- WColorBarH(rep(c(1,2,3),4), Beneath(RBind(p$heatmap, p$color.bar.middle, p$color.bar, p$heatmap2)), cmp=CMPar(brewer.name='set2'))
WPlot(p)
```
